{
	"fileTypes": [],
	"injectionSelector": "L:meta.template",
	"name": "ng-template",
	"patterns": [
		{
			"include": "#template-ng"
		}
	],
	"repository": {
		"template-ng": {
			"begin": "\\r?\\n",
			"beginCaptures": {
				"0": {
					"name": "string.template"
				}
			},
			"end": "(?=`)",
			"endCaptures": {
				"0": {
					"name": "string.template"
				}
			},
			"name": "meta.template",
			"patterns": [
				{
					"include": "#comment-block"
				},
				{
 					"include": "#ng-style"
  			    },
				{
					"include": "#ng"
				},
				{
					"include": "source.ts"
				}
			]
		},

		"ng-style": {
			"begin": "(<)([Ss][Tt][Yy][Ll][Ee])(>)",
			"beginCaptures": {
				"1": {
					"name": "punctuation.definition.tag.begin"
				},
				"2": {
					"name": "entity.name.tag"
				},
				"3": {
					"name": "punctuation.definition.tag.end"
				}
			},
			"end": "(</)([Ss][Tt][Yy][Ll][Ee])(>)",
			"endCaptures": {
				"1": {
					"name": "punctuation.definition.tag.begin"
				},
				"2": {
					"name": "entity.name.tag"
				},
				"3": {
					"name": "punctuation.definition.tag.end"
				}
			},
			"name": "ng-style",
			"patterns": [
				{
					"include": "source.css"
				}
			]
		},

		"ng": {
			"name": "meta.ng",
			"patterns": [
				{
					"include": "#ng-tag-comment"
				},
				{
					"include": "#ng-tag-open"
				},
				{
					"include": "#ng-evaluated-code"
				},
				{
					"include": "#ng-tag-close"
				},
				{
					"include": "#ng-tag-invalid"
				},
				{
					"begin": "(?<=(?:'|\"|})>)",
					"end": "(?=</)",
					"name": "meta.ng.children",
					"patterns": [
						{
							"include": "#ng-children"
						}
					]
				}
			]
		},

		"ng-children": {
			"patterns": [
				{
					"include": "#ng-tag-comment"
				},
				{
					"include": "#ng-tag-open"
				},
				{
					"include": "#ng-evaluated-code"
				},
				{
					"include": "#ng-tag-close"
				},
				{
					"include": "#ng-tag-invalid"
				},
				{
					"include": "#ng-entities"
				}
			]
		},

		"ng-tag-comment": {
			"begin": "<!--",
			"end": "-->",
			"name": "comment.block"
		},

		"ng-entities": {
			"patterns": [
				{
					"captures": {
						"1": {
							"name": "punctuation.definition.entity"
						},
						"3": {
							"name": "punctuation.definition.entity"
						}
					},
					"match": "(&)([a-zA-Z0-9]+|#[0-9]+|#x[0-9a-fA-F]+)(;)",
					"name": "constant.character.entity"
				},
				{
					"match": "&",
					"name": "invalid.illegal.bad-ampersand"
				}
			]
		},

		"ng-evaluated-code": {
			"begin": "{{",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.brace.curly.start"
				}
			},
			"end": "}}",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.brace.curly.end"
				}
			},
			"name": "meta.brace.curly",
			"patterns": [
			    {
			        "include": "#ng-stash-keys"
			    },
				{
					"include": "source.ts"
				}
			]
		},
		
		"ng-stash-keys": {
			"match": " *([$]?[a-zA-Z0-9_]+[.]?)+",
			"name": "punctuation.definition.keys"
		},		

		"ng-string-double-quoted": {
			"begin": "\"",
			"beginCaptures": {
				"0": {
					"name": "punctuation.definition.string.begin"
				}
			},
			"end": "\"\\s*",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.string.end"
				}
			},
			"name": "string.quoted.double"
		},
        
		"ng-tag-attribute-assignment": {
			"match": "=",
			"name": "keyword.operator.assignment"
		},

		"ng-tag-attribute-name": {
			"match": "[a-zA-Z_$@:*#.-]+\\s*",
			"name": "meta.tag.attribute-name"
		},		

		"ng-tag-attributes": {
			"patterns": [
				{
					"include": "#ng-tag-attribute-name"
				},
				{
					"include": "#ng-tag-attribute-assignment"
				},
				{
					"include": "#ng-string-double-quoted"
				}
			]
		},
        
		"ng-tag-close": {
			"match": "\\s*(</)[a-z0-9-]+(>)",
			"captures": {
				"0": {
					"name": "entity.name.tag"
				},
				"1": {
					"name": "punctuation.definition.tag.begin"
				},
				"2": {
					"name": "punctuation.definition.tag.end"
				}
			},
			"name": "tag.close"
		},

		"ng-tag-invalid": {
			"match": "<\\s*>",
			"name": "invalid.illegal.tag.incomplete"
		},

		"ng-tag-open": {
			"begin": "(<)[a-z0-9-]+\\s*",
			"beginCaptures": {
				"0": {
					"name": "entity.name.tag"
				},
				"1": {
					"name": "punctuation.definition.tag.begin"
				}
			},
			"end": "/?>",
			"endCaptures": {
				"0": {
					"name": "punctuation.definition.tag.end"
				}
			},
			"name": "tag.open",
			"patterns": [
				{
					"include": "#ng-tag-attributes"
				}
			]
		}
	},
	"scopeName": "template.ng"
}
